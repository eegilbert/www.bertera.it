<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Pietro Bertera's Blog</title><link href="http://www.bertera.it/" rel="alternate"></link><link href="http://www.bertera.it/feeds/coding.atom.xml" rel="self"></link><id>http://www.bertera.it/</id><updated>2008-12-17T15:04:00+01:00</updated><entry><title>Reading Windows and Office product key</title><link href="http://www.bertera.it/reading-windows-and-office-product-key.html" rel="alternate"></link><published>2008-12-17T15:04:00+01:00</published><author><name>admin</name></author><id>tag:www.bertera.it,2008-12-17:reading-windows-and-office-product-key.html</id><summary type="html">&lt;p&gt;I product key di M\$ Windows e Office vengono salvati nel registro in
alcune chiavi cifrate&lt;br /&gt;
Pygetkey decifra le chiavi e le stampa a video oppure le salva in
chiaro in un'altra chiave di registro. Puo' inoltre preleveare i product
key da un pc remoto.&lt;/p&gt;
&lt;p&gt;Pygetkey è scritto in python e richiede un'installazione di python 2.X
per windows&lt;/p&gt;
&lt;p&gt;Esempio:  &lt;code&gt;pygetkey -c SYSTEMTest&lt;/code&gt; creerà i valori WINDOWS-KEY e OFFICE-2007-KEY all'interno della chiave
HKEY_LOCAL_MACHINESYSTEMTest:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[HKEY_LOCAL_MACHINESYSTEMTest] &amp;quot;WINDOWS-KEY&amp;quot;=&amp;quot;XQM13-K3M7R-32HRX-XF3Q-GMF63&amp;quot; &amp;quot;OFFICE-2007-KEY&amp;quot;=&amp;quot;JPBW9-BPY6B-79M9M-RJYJV-6G5B6&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;i valori vengono creati sotto l'albero di registro HKEY_LOCAL_MACHINE
nella chiave specificata dal parametro -c e potranno avere i seguenti nomi:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WINDOWS-KEY: la chiave di windows  &lt;/li&gt;
&lt;li&gt;OFFICE-{2000,2007,2003,XP}-KEY: le chiavi di office trovate a seconda della versione&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La chiave specificata dal comando DEVE esistere, in caso contrario
verrà ritornato un errore.&lt;/p&gt;
&lt;p&gt;L'opzione -r HOST indica a pygetkey di interrogare un host remoto.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Leggere chiavi di registro su un pc remoto:&lt;/strong&gt;&lt;br /&gt;
readrreg.py è ingrado di leggere le chiavi di registro da un pc remoto:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;devgetkey&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;readrreg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;py&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SYSTEMTest&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="n"&gt;RemotePC&lt;/span&gt; &lt;span class="n"&gt;office&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2007&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;XQM13&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;K3M7R&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="n"&gt;HRX&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;XF3Q&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GMF63&lt;/span&gt; &lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;JPBW9&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;BPY6B&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;79&lt;/span&gt;&lt;span class="n"&gt;M9M&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;RJYJV&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="n"&gt;G5B6&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Creazione dei binari&lt;/strong&gt;&lt;br /&gt;
E' possibile creare un eseguibile di pygetkey e readrreg in modo da non
installare python sui pc, per creare i binari occorre&lt;br /&gt;
installare py2exe (http://www.py2exe.org) per l'appropriata versione di&lt;/p&gt;
&lt;p&gt;Python ed eseguire il seguente comando: &lt;code&gt;python.exe setup.py py2exe&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Qesto creera' una directory dist contente dei file, quelli strettamente
necessari all'esecuzione di pygetkey.exe e readrreg.exe sono:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pygetkey.exe  &lt;/li&gt;
&lt;li&gt;readrreg.exe  &lt;/li&gt;
&lt;li&gt;library.zip  &lt;/li&gt;
&lt;li&gt;python25.dll (il 25 dipende dalla versione di Python installata)  &lt;/li&gt;
&lt;li&gt;MSVCR71.dll&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PS: non sono sicuro funzioni correttamente con Office 2000&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt;  &lt;/p&gt;
&lt;p&gt;pygetkey è scaricabile &lt;a href="https://github.com/pbertera/junk/tree/master/pygetkey"&gt;qua&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;python è scaricabile all'indirizzo: &lt;a href="http://www.python.org"&gt;http://www.python.org&lt;/a&gt;&lt;br /&gt;
py2exe è scaricabile all'indirizzo: &lt;a href="http://www.py2exe.org"&gt;http://www.py2exe.org&lt;/a&gt;&lt;/p&gt;</summary><category term="product key"></category><category term="python"></category><category term="registry"></category><category term="windows"></category></entry><entry><title>Worstbit posix acl</title><link href="http://www.bertera.it/worstbit-posix-acl.html" rel="alternate"></link><published>2008-09-26T18:05:00+02:00</published><author><name>admin</name></author><id>tag:www.bertera.it,2008-09-26:worstbit-posix-acl.html</id><summary type="html">&lt;p&gt;Software C che si occupa dell'encode e decode dei filename contenuti nei dump del comando&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; getfacl -R
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;a href="https://github.com/pbertera/junk/tree/master/worstbit"&gt;https://github.com/pbertera/junk/tree/master/worstbit&lt;/a&gt;&lt;/p&gt;</summary><category term="acl posix"></category><category term="c"></category></entry></feed>