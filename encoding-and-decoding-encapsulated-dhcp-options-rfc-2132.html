<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://bertera.it/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="http://bertera.it/theme/pygments/default.min.css">
  <link rel="stylesheet" type="text/css" href="http://bertera.it/theme/font-awesome/css/font-awesome.min.css">


    <link href="http://bertera.it/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Pietro Bertera's Blog Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#ff3333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#ff3333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="admin" />
<meta name="description" content="Vendor specific DHCP options may be provided encapsulated in DHCP option 43. With this little script you can encode and decode vendor encapsulated option according to RFC 2132. For example with this command you can tunnel options 66 (TFTP Server), 67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS ..." />
<meta name="keywords" content="decoding, dhcp, encapsulated options, encoding, python, rfc2132">
<meta property="og:site_name" content="Pietro Bertera's Blog"/>
<meta property="og:title" content="Encoding and decoding Encapsulated DHCP options (RFC 2132)"/>
<meta property="og:description" content="Vendor specific DHCP options may be provided encapsulated in DHCP option 43. With this little script you can encode and decode vendor encapsulated option according to RFC 2132. For example with this command you can tunnel options 66 (TFTP Server), 67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS ..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://bertera.it/encoding-and-decoding-encapsulated-dhcp-options-rfc-2132.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2012-10-19 10:38:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://bertera.it/author/admin.html">
<meta property="article:section" content="scripts, systems"/>
<meta property="article:tag" content="decoding"/>
<meta property="article:tag" content="dhcp"/>
<meta property="article:tag" content="encapsulated options"/>
<meta property="article:tag" content="encoding"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="rfc2132"/>
<meta property="og:image" content="//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120">
  <title>Pietro Bertera's Blog &ndash; Encoding and decoding Encapsulated DHCP options (RFC 2132)</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://bertera.it">
        <img src="//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120" alt="Pietro Bertera" title="Pietro Bertera">
      </a>
      <h1><a href="http://bertera.it">Pietro Bertera</a></h1>
<p>Something about IT, sports and life</p>      <nav>
        <ul class="list">
          <li><a href="http://bertera.it/pages/about.html#about">About</a></li>
          <li><a href="http://bertera.it/pages/contact.html#contact">Contact</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/pietrobertera" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/pbertera" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/pbertera" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="//bertera.it/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="http://bertera.it">Home</a>
      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="http://bertera.it/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h1 id="encoding-and-decoding-encapsulated-dhcp-options-rfc-2132">Encoding and decoding Encapsulated DHCP options (RFC 2132)</h1>
    <p>Posted on Fri 19 October 2012 in <a href="http://bertera.it/category/scripts-systems.html">scripts, systems</a></p>
  </header>
  <div>
    <p>Vendor specific DHCP options may be provided encapsulated in DHCP option
43.<br />
With <a href="http://bertera.it/static/dhcp-encapsulated-options.py">this little script</a> you
can encode and decode vendor encapsulated option according to <a href="http://www.ietf.org/rfc/rfc2132.txt">RFC
2132</a>.</p>
<p>For example with this command you can tunnel options 66 (TFTP Server),
67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS):</p>
<div class="highlight"><pre><span></span>$ ./dhcp-encapsulated-options.py encode <span class="m">66</span> http://provisionig.example.com <span class="m">67</span> settings.xml <span class="m">132</span> <span class="m">33</span> <span class="m">133</span> 6
Encoding part 1: http://provisionig.example.com
 Option ID: 66
 Option length: 30
 Encoded Option part: 42:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D

Encoding part 2: settings.xml
 Option ID: 67
 Option length: 12
 Encoded Option part: 43:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C

Encoding part 3: 33
 Option ID: 132
 Option length: 2
 Encoded Option part: 84:02:33:33

Encoding part 4: 6
 Option ID: 133
 Option length: 1
 Encoded Option part: 85:01:36

Full encoded options: 42:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D:43:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C:84:02:33:33:85:01:36
</pre></div>


<p>And then you can add the encoded options in you dhcpd config file:</p>
<div class="highlight"><pre><span></span><span class="nt">host</span> <span class="nt">device</span><span class="nc">.labo.local</span> <span class="p">{</span>  
    <span class="n">hardware</span> <span class="n">ethernet</span> <span class="m">01</span><span class="o">:</span><span class="m">04</span><span class="o">:</span><span class="m">23</span><span class="o">:</span><span class="m">3</span><span class="n">b</span><span class="o">:</span><span class="n">d0</span><span class="o">:</span><span class="m">21</span><span class="p">;</span>  
    <span class="nb">fixed</span><span class="o">-</span><span class="n">address</span> <span class="m">172</span><span class="o">.</span><span class="m">16</span><span class="o">.</span><span class="m">18</span><span class="o">.</span><span class="m">30</span><span class="p">;</span>  
    <span class="n">option</span> <span class="n">vendor</span><span class="o">-</span><span class="n">encapsulated</span><span class="o">-</span><span class="n">options</span>
    <span class="m">42</span><span class="o">:</span><span class="m">1</span><span class="n">E</span><span class="o">:</span><span class="m">68</span><span class="o">:</span><span class="m">74</span><span class="o">:</span><span class="m">74</span><span class="o">:</span><span class="m">70</span><span class="o">:</span><span class="m">3</span><span class="n">A</span><span class="o">:</span><span class="m">2</span><span class="n">F</span><span class="o">:</span><span class="m">2</span><span class="n">F</span><span class="o">:</span><span class="m">70</span><span class="o">:</span><span class="m">72</span><span class="o">:</span><span class="m">6</span><span class="n">F</span><span class="o">:</span><span class="m">76</span><span class="o">:</span><span class="m">69</span><span class="o">:</span><span class="m">73</span><span class="o">:</span><span class="m">69</span><span class="o">:</span><span class="m">6</span><span class="n">F</span><span class="o">:</span><span class="m">6</span><span class="n">E</span><span class="o">:</span><span class="m">69</span><span class="o">:</span><span class="m">67</span><span class="o">:</span><span class="m">2</span><span class="n">E</span><span class="o">:</span><span class="m">65</span><span class="o">:</span><span class="m">78</span><span class="o">:</span><span class="m">61</span><span class="o">:</span><span class="m">6</span><span class="n">D</span><span class="o">:</span><span class="m">70</span><span class="o">:</span><span class="m">6</span><span class="n">C</span><span class="o">:</span><span class="m">65</span><span class="o">:</span><span class="m">2</span><span class="n">E</span><span class="o">:</span><span class="m">63</span><span class="o">:</span><span class="m">6</span><span class="n">F</span><span class="o">:</span><span class="m">6</span><span class="n">D</span><span class="o">:</span><span class="m">43</span><span class="o">:</span><span class="m">0</span><span class="n">C</span><span class="o">:</span><span class="m">73</span><span class="o">:</span><span class="m">65</span><span class="o">:</span><span class="m">74</span><span class="o">:</span><span class="m">74</span><span class="o">:</span><span class="m">69</span><span class="o">:</span><span class="m">6</span><span class="n">E</span><span class="o">:</span><span class="m">67</span><span class="o">:</span><span class="m">73</span><span class="o">:</span><span class="m">2</span><span class="n">E</span><span class="o">:</span><span class="m">78</span><span class="o">:</span><span class="m">6</span><span class="n">D</span><span class="o">:</span><span class="m">6</span><span class="n">C</span><span class="o">:</span><span class="m">84</span><span class="o">:</span><span class="m">02</span><span class="o">:</span><span class="m">33</span><span class="o">:</span><span class="m">33</span><span class="o">:</span><span class="m">85</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="m">36</span><span class="p">;</span>  
<span class="p">}</span>
</pre></div>


<p>And viceversa you can decode an encapsulated option:</p>
<div class="highlight"><pre><span></span>$ ./dhcp-encapsulated-options.py decode 42:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D:43:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C
Decoding part 1: 42:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D
 Option ID: 66
 Option lenght: 30
 Option value: <span class="s2">&quot;http://provisionig.example.com&quot;</span>

Decoding part 2: 43:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C
 Option ID: 67
 Option lenght: 12
 Option value: <span class="s2">&quot;settings.xml&quot;</span>

End of encoded options
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://bertera.it/tag/decoding.html">decoding</a>
      <a href="http://bertera.it/tag/dhcp.html">dhcp</a>
      <a href="http://bertera.it/tag/encapsulated-options.html">encapsulated options</a>
      <a href="http://bertera.it/tag/encoding.html">encoding</a>
      <a href="http://bertera.it/tag/python.html">python</a>
      <a href="http://bertera.it/tag/rfc2132.html">rfc2132</a>
    </p>
  </div>
</article>

    <footer>
<p>
  &copy; Pietro Bertera 2016 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>Built using <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pietro Bertera's Blog ",
  "url" : "http://bertera.it",
  "image": "//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120",
  "description": "Pietro Bertera's Thoughts and Writings"
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Encoding and decoding Encapsulated DHCP options (RFC 2132)",
  "headline": "Encoding and decoding Encapsulated DHCP options (RFC 2132)",
  "datePublished": "2012-10-19 10:38:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "admin",
    "url": "http://bertera.it/author/admin.html"
  },
  "image": "//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120",
  "url": "http://bertera.it/encoding-and-decoding-encapsulated-dhcp-options-rfc-2132.html",
  "description": "Vendor specific DHCP options may be provided encapsulated in DHCP option 43. With this little script you can encode and decode vendor encapsulated option according to RFC 2132. For example with this command you can tunnel options 66 (TFTP Server), 67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS ..."
}
</script></body>
</html>